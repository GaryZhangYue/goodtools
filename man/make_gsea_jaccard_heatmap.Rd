% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_gsea_jaccard_heatmap.R
\name{make_gsea_jaccard_heatmap}
\alias{make_gsea_jaccard_heatmap}
\title{Jaccard-based pathway clustering and discrete NES heatmap}
\usage{
make_gsea_jaccard_heatmap(
  df.full,
  padj_cutoff = 0.05,
  threshold_positive = 2,
  threshold_negative = -2,
  hclust_method = "average",
  hcut = NA_real_,
  branch_palette = NULL,
  branches_lwd = 1.2,
  row_split = c("none", "by_hcut"),
  cluster_columns = FALSE,
  heatmap_width_cm = 2.5,
  row_dend_width_cm = 12,
  row_label_fontsize = 6,
  row_label_bold = TRUE,
  row_names_max_width_cm = 20,
  cell_border_col = "black",
  cell_border_lwd = 0.4,
  pdf_heatmap = "NES_heatmap.pdf",
  pdf_dendrogram = "full_gene_list_dendrogram.pdf",
  pdf_width = 14,
  pdf_height = 15,
  plot_dendrogram = TRUE,
  show_progress = FALSE
)
}
\arguments{
\item{df.full}{A data.frame containing pathway-level GSEA results.
Must include columns: \code{Contrast}, \code{Pathway}, \code{NES}, \code{p.adjust},
and \code{full_gene_list}.
\code{full_gene_list} may be either a list-column of character vectors
or a comma-separated character string of genes.}

\item{padj_cutoff}{Numeric. Adjusted p-value cutoff for pathway filtering. Default \code{0.05}.}

\item{threshold_positive}{Numeric. Positive NES threshold; values greater than this map to \code{+1}.}

\item{threshold_negative}{Numeric. Negative NES threshold; values less than this map to \code{-1}.}

\item{hclust_method}{Character. Linkage method for \code{stats::hclust()}. Default \code{"average"}.}

\item{hcut}{Numeric or \code{NA}. Height to cut dendrogram for branch coloring. Default \code{NA} (no coloring).}

\item{branch_palette}{Character vector of colors for dendrogram branches when \code{hcut} is specified.}

\item{branches_lwd}{Numeric. Line width for colored dendrogram branches.}

\item{row_split}{Character. \code{"none"} (default) or \code{"by_hcut"}. If \code{"by_hcut"} and \code{hcut} provided,
heatmap rows are split by dendrogram clusters.}

\item{cluster_columns}{Logical. Whether to cluster heatmap columns (contrasts). Default \code{FALSE}.}

\item{heatmap_width_cm}{Numeric. Width of the heatmap body in centimeters.}

\item{row_dend_width_cm}{Numeric. Width of the row dendrogram in centimeters.}

\item{row_label_fontsize}{Numeric. Font size for pathway (row) labels.}

\item{row_label_bold}{Logical. Whether pathway labels are bold.}

\item{row_names_max_width_cm}{Numeric. Maximum width allowed for row labels (cm).}

\item{cell_border_col}{Character. Color of cell borders in the heatmap.}

\item{cell_border_lwd}{Numeric. Line width of cell borders.}

\item{pdf_heatmap}{Character. Output heatmap PDF filename.}

\item{pdf_dendrogram}{Character. Output dendrogram PDF filename.}

\item{pdf_width}{Numeric. Width of output PDFs (inches).}

\item{pdf_height}{Numeric. Height of output PDFs (inches).}

\item{plot_dendrogram}{Logical. Whether to save a standalone dendrogram PDF.}

\item{show_progress}{Logical. Whether to print progress during distance computation.}
}
\value{
Invisibly returns a list with components:
\describe{
\item{df}{Filtered pathway data used for plotting}
\item{dmat}{Jaccard distance matrix}
\item{hc}{\code{hclust} object}
\item{dend}{Dendrogram derived from \code{hc}}
\item{dend_col}{Colored dendrogram (if \code{hcut} is used; otherwise \code{NULL})}
\item{nes_mat}{Numeric NES matrix (pathway x contrast)}
\item{nes_disc}{Discrete NES matrix with values -1, 0, 1}
\item{heatmap}{\code{ComplexHeatmap} heatmap object}
}
}
\description{
Perform hierarchical clustering of pathways using Jaccard distance on
full gene sets, and visualize discrete normalized enrichment scores (NES)
across contrasts as a heatmap with an aligned dendrogram.
}
\details{
This function assumes that \code{df.full} has already been prepared and
contains a \code{full_gene_list} column (one identical gene set per pathway
across contrasts). No GMT files are read inside this function.

Workflow:
\enumerate{
\item filter pathways by adjusted p-value and NES thresholds
\item compute a Jaccard distance matrix between pathways (full gene sets)
\item hierarchical clustering (default: average linkage)
\item optional dendrogram branch coloring by cut height
\item discrete NES heatmap (-1, 0, 1) with aligned dendrogram
\item save dendrogram and heatmap as PDF files
}

Jaccard distance is defined as:
\deqn{1 - \frac{|A \cap B|}{|A \cup B|}}

Discrete NES mapping:
\itemize{
\item \code{NES > threshold_positive -> +1}
\item \code{NES < threshold_negative -> -1}
\item otherwise \verb{-> 0}
}
}
\seealso{
\code{ComplexHeatmap::Heatmap()}, \code{dendextend::color_branches()}, \code{stats::hclust()}
}
